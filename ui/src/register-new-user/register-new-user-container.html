<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../redux-behavior.html">
<link rel="import" href="./register-new-user-view.html">

<dom-module id="register-new-user-container">
  <template>
    <register-new-user-view
      id="view"
      has-error="[[hasError]]"
      error-text="[[errorText]]"
      is-signed-in="[[isSignedIn]]"
      is-signed-out="[[isSignedOut]]"
      is-pending="[[isPending]]"
    >
    </register-new-user-view>
  </template>
  <script>
    Polymer({
      is: 'register-new-user-container',
      behaviors: [ReduxBehavior],
      properties: {
        message: {
          type: String,
          value: '',
        },
        hasError: {
          type: Boolean,
          statePath: app.auth.hasError,
        },
        errorText: {
          type: String,
          statePath: app.auth.getErrorText,
        },
        isSignedIn: {
          type: Boolean,
          statePath: app.auth.isSignedIn,
        },
        isSignedOut: {
          type: Boolean,
          statePath: app.auth.isSignedOut,
        },
        isPending: {
          type: Boolean,
          statePath: app.auth.isPending,
        },
      },
      actions: {
        createUserWithEmailAndPassword: app.auth.createUserWithEmailAndPassword,
        resetError: app.auth.resetError,
      },
      listeners: {
        'register-new-user': '_register',
        'register-new-user-dismissed': '_registerDismissed',
      },
      _registerDismissed: function() {
        this.dispatch('resetError');
      },
      _register: function(event) {
        return this.dispatch(
          'createUserWithEmailAndPassword',
          event.detail.email,
          event.detail.password
        );
      },
      show: function(params) {
        this.$.view.show(params);
      },
    });
  </script>
</dom-module>
